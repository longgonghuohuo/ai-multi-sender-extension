# 🧪 AI Multi Sender - 测试说明

## 修复内容总结

### ✅ 已修复的问题

1. **按钮点击无效** ❌ → ✅
   - 旧代码: 主按钮调用 `sendInParallelWindows()` (错误)
   - 新代码: 主按钮调用 `sendToAll()` (正确)

2. **黑屏/iframe问题** ❌ → ✅
   - 已删除: `multiview.html` 和 `multiview.js`
   - 原因: AI网站禁止iframe嵌入

3. **没有三个并排** ❌ → ✅
   - 优化了窗口位置计算
   - 添加了 `screenLeft` 和 `screenTop` 偏移量
   - 设置 `state: 'normal'` 防止最大化

4. **快捷键vs按钮混乱** ❌ → ✅
   - `Ctrl+Enter`: 发送到已打开标签页
   - `Ctrl+Shift+Enter`: 并排窗口模式

5. **缺少"打开AI"按钮** ❌ → ✅
   - 添加了"📂 打开所有AI"按钮
   - 调整了按钮布局

---

## 🧪 测试步骤

### 测试1: 标签页模式

1. 打开 Chrome,加载扩展
2. 点击扩展图标
3. 点击"📂 打开所有AI"按钮
4. 等待3个标签页打开(ChatGPT, Gemini, Claude)
5. 在输入框输入"你好,测试一下"
6. 点击"🚀 发送到所有AI"按钮 **或** 按 `Ctrl+Enter`
7. 切换到每个标签页检查是否填充了问题

**预期结果**:
- ✅ 三个标签页都成功打开
- ✅ 问题填充到所有输入框
- ✅ 显示"✅ 成功发送到 N 个 AI"提示

---

### 测试2: 并排窗口模式

1. 点击扩展图标
2. 在输入框输入"测试并排窗口"
3. 点击"🪟 并排窗口模式"按钮 **或** 按 `Ctrl+Shift+Enter`
4. 观察是否打开3个窗口

**预期结果**:
- ✅ 三个窗口并排显示(左、中、右)
- ✅ 每个窗口宽度约为屏幕的1/3
- ✅ 问题自动填充(需要等待1.5秒)
- ✅ 显示"✅ 三个窗口已创建并排列!"提示

---

### 测试3: 快捷键

| 快捷键 | 预期功能 |
|--------|---------|
| `Ctrl+Enter` | 发送到已打开的标签页 |
| `Ctrl+Shift+Enter` | 创建并排窗口 |

---

### 测试4: 历史记录

1. 发送几个问题
2. 查看下方"📝 历史提问"区域
3. 点击一条历史记录
4. 检查是否填充到输入框
5. 点击"📥 导出"按钮
6. 检查是否下载了Markdown文件

---

## ⚠️ 已知限制

1. **自动填充延迟**: 并排窗口模式下,问题填充需要等待1.5秒(页面加载)
2. **网络要求**: ChatGPT/Claude需要科学上网
3. **自动发送**: 目前不会自动点击发送按钮(安全考虑)

---

## 🐛 如何调试

如果遇到问题:

1. **打开浏览器控制台**
   ```
   F12 → Console 标签
   ```

2. **查看扩展日志**
   - 在AI网页上看到 `[发送]` 开头的日志
   - 在扩展页面看到 `[并排窗口]` 开头的日志

3. **检查content script是否注入**
   ```javascript
   // 在ChatGPT页面控制台输入:
   console.log('Content script loaded:', !!document.querySelector('#prompt-textarea'))
   ```

4. **重新加载扩展**
   - 访问 `chrome://extensions/`
   - 找到 AI Multi Sender
   - 点击刷新图标

---

## 📊 测试检查清单

- [ ] 标签页模式能正常发送
- [ ] 并排窗口能正确并排
- [ ] "打开所有AI"按钮正常工作
- [ ] "发送到所有AI"按钮正常工作
- [ ] "并排窗口模式"按钮正常工作
- [ ] `Ctrl+Enter` 快捷键正常
- [ ] `Ctrl+Shift+Enter` 快捷键正常
- [ ] 历史记录正常保存
- [ ] 历史记录导出正常
- [ ] 问题自动填充到ChatGPT
- [ ] 问题自动填充到Claude
- [ ] 问题自动填充到Gemini

---

**测试完成后请告诉我结果!** 🎯
